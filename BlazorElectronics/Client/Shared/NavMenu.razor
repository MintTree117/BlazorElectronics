@using BlazorElectronics.Shared.DataTransferObjects.Categories
@using BlazorElectronics.Client.Services.Categories
@inject ICategoryServiceClient CategoryService
@inject NavigationManager NavManager

<nav class="navbar navbar-dark bg-dark">
    <div class="nav-sidebar @NavMenuCssClass">
        <CategoryList></CategoryList>
    </div>
    <div class="top-nav">
        <button class="btn btn-info" onclick="@ToggleNavMenu">
            <i class="oi oi-menu"></i>
        </button>
        <button class="btn btn-primary home-brand" onclick="@GoToHome">
            Blazor Electronics
        </button>
        <ProductSearchBar></ProductSearchBar>
        <CartCounter></CartCounter>
    </div>
</nav>

@code 
{
    bool _loadedCategories = false;
    bool _collapseNavMenu = true;
    string _categoryMessage = "Loading Categories...";
    string? NavMenuCssClass => _collapseNavMenu ? "nav-sidebar-hide" : "";

    Categories_DTO? _categories;

    protected override async Task OnInitializedAsync()
    {
        _categories = await CategoryService.GetCategories();
        _loadedCategories = true;

        if ( _categories == null )
        {
            _categoryMessage = "Failed to load categories!";
            return;
        }
    }
    void ToggleNavMenu()
    {
        _collapseNavMenu = !_collapseNavMenu;
        StateHasChanged();
    }
    void GoToHome()
    {
        NavManager.NavigateTo( "" );
    }
}